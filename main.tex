\PassOptionsToPackage{full}{textcomp}
% include symmetric to place margins left and right instead of right only
% nohyper, nobib?
\documentclass[nobib,a4paper,twoside,notoc,justified,marginals=justified]{tufte-book}
% \documentclass{caesar_book}
\usepackage[utf8]{inputenc}

% \usepackage{hyperref}
\hypersetup{colorlinks}

% \usepackage{setspace}
% \newcommand{\newthought}[1]{\textsc{#1}}

%%
% For nicely typeset tabular material
\usepackage{booktabs}

% fix too many alphabets error
\usepackage{amsmath, amssymb}
\newcommand\hmmax{0}
\newcommand\bmmax{0}

% fix margins?
% \usepackage{marginfix}

\usepackage{enumitem, bm, xcolor, braket, dsfont, graphicx, cancel}
\usepackage[multidot]{grffile}
% \usepackage[colorlinks, linkcolor = red, citecolor = black, filecolor = black, urlcolor = blue]{hyperref} 
% \usepackage{nameref}
% \hypersetup{colorlinks}
\usepackage{algorithmic}
\usepackage{todonotes}

% Quotes
\usepackage{epigraph}
\setlength\epigraphwidth{10cm}
\setlength\epigraphrule{0pt}

%% style
% \usepackage{mathptmx}
% \usepackage{setspace}
% \linespread{1.0}

% \iflarger
%\AtBeginDocument{%
%	\fontsize{12}{14}\selectfont
%}%
% \else\fi


% integrate amsthm and txmath
\usepackage{savesym}
\usepackage{amsthm}
\savesymbol{openbox}
\usepackage{newtxtext,newtxmath}
\restoresymbol{TX}{openbox}

% theorems
\newtheorem*{theorem}{Theorem}
\newtheorem*{thm}{Theorem}

% shorthand
\renewcommand{\t}[1]{\text{#1}}
\renewcommand{\d}{{\rm d}}
\renewcommand{\b}[1]{{\bf #1}}
\newcommand{\B}[1]{\mathbf{#1}}
\newcommand{\D}[1]{{#1}^\dagger}
\newcommand{\fD}[1]{{#1}^{ \phantom{\dagger}}}
\renewcommand{\P}[1]{{#1}^\prime}
\newcommand{\fP}[1]{{#1}^{\phantom{\prime}}}
\newcommand{\im}{{\rm i}}
\newcommand{\halb}{\frac{1}{2}}
\DeclareMathOperator{\Tr}{Tr}
\newcommand{\kb}{k_{\rm B}}
\newcommand{\sigmaA}{\sigma^\mathrm{A}}
\newcommand{\sigmaAOS}{\sigma^\mathrm{A}_\mathrm{OS}}
\newcommand{\sigmaAMD}{\sigma^\mathrm{A}_\mathrm{MD}}

% transpose
\usepackage{relsize}
\newcommand{\tp}[1]{{#1}^{\mathrm t}}
% \!\: = 1mu distance; \!\; = 2mu (\, = 3mu)
\newcommand{\itp}[1]{{#1}^{\!\:\scalebox{0.55}[1.0]{\( - \)}1 \mathrm t}}

% comments:
% dblue: https://coolors.co/1f77b4
\definecolor{dblue}{RGB}{31,119,180}
\definecolor{dblue_light}{HTML}{5AAAE3}
\definecolor{purple_light}{HTML}{A61EB3}
\definecolor{yellow1}{HTML}{E7EB90}
\definecolor{yellow2}{HTML}{FADF63}
\definecolor{yellow3}{HTML}{E6AF2E}
\definecolor{red_light}{HTML}{FE404A}
\definecolor{cite}{HTML}{2BB31E}
\definecolor{djordje}{RGB}{192,225,215}
\newcommand{\MOVE} [1] 
{\todo[inline,backgroundcolor=red_light, bordercolor=white]{{\bf MOVE:} #1}}
\newcommand{\REM} [1] 
{\todo[inline,backgroundcolor=dblue_light, bordercolor=white]{{\bf REM:} #1}}
\newcommand{\CITE} [1] 
{\todo[inline,backgroundcolor=cite, bordercolor=white]{{\bf CITE:} #1}}
% \newcommand{\FK}[1]{\textcolor{blue}{{\bf #1 }}}
\newcommand{\TODO} [1] 
{\todo[inline,backgroundcolor=red, bordercolor=white]{{\bf TODO:} #1}}
\newcommand{\ADD} [1] 
{\todo[inline,backgroundcolor=red, bordercolor=white]{{\bf ADD} #1}}
\newcommand{\FK} [1] 
{\todo[inline,backgroundcolor=yellow2, bordercolor=white]{{\bf Florian:} #1}}
\newcommand{\idea} [1] 
{\todo[inline,backgroundcolor=red, bordercolor=white]{{\bf idea:} #1}}
\newcommand{\inlinecomment}[1]{\textcolor{red}{{\bf #1 }}}
\newcommand{\prelim}[1]{\textcolor{red}{{\bf prelim:} {\it #1 }}}
\newcommand{\CC} [1] 
{\todo[inline,backgroundcolor=yellow3, bordercolor=white]{{\bf CC:} #1}}

% Tufte

% TOC
% https://tex.stackexchange.com/questions/121790/how-to-generate-a-full-width-table-of-contents-tufte-book
\usepackage{lipsum,mdframed}
\definecolor{secnum}{RGB}{13,151,225}
\definecolor{ptcbackground}{RGB}{212,237,252}
\definecolor{ptctitle}{RGB}{0,177,235}

\setcounter{secnumdepth}{3}

\usepackage[toc]{appendix}
% \usepackage{titletoc}
% \usepackage{etoolbox}
\setcounter{tocdepth}{1}
%\pretocmd{\tableofcontents}{\begin{mdframed}\let\cleardoublepage\relax}{}{}
%  \apptocmd{\tableofcontents}{\end{mdframed}}{}{}

% The fancyvrb package lets us customize the formatting of verbatim
% environments.  We use a slightly smaller font.
\usepackage{fancyvrb}
\fvset{fontsize=\normalsize}

%%
% Prints argument within hanging parentheses (i.e., parentheses that take
% up no horizontal space).  Useful in tabular environments.
\newcommand{\hangp}[1]{\makebox[0pt][r]{(}#1\makebox[0pt][l]{)}}

%%
% Prints an asterisk that takes up no horizontal space.
% Useful in tabular environments.
\newcommand{\hangstar}{\makebox[0pt][l]{*}}

%%
% Prints a trailing space in a smart way.
\usepackage{xspace}

% Prints the month name (e.g., January) and the year (e.g., 2008)
\newcommand{\monthyear}{%
  \ifcase\month\or January\or February\or March\or April\or May\or June\or
  July\or August\or September\or October\or November\or
  December\fi\space\number\year
}

% http://tex.stackexchange.com/a/140164/1913
% \ifxetex
% xetex fix https://tex.stackexchange.com/a/200725/91226
%\ifx\ifxetex\ifluatex\else % if lua- or xelatex   \newcommand{\textls}[2][5]{%
%    \begingroup\addfontfeatures{LetterSpace=#1}#2\endgroup
%  }
%  \renewcommand{\allcapsspacing}[1]{\textls[15]{#1}}
%  \renewcommand{\smallcapsspacing}[1]{\textls[10]{#1}}
%  \renewcommand{\allcaps}[1]{\textls[15]{\MakeTextUppercase{#1}}}
%  \renewcommand{\smallcaps}[1]{\smallcapsspacing{\scshape\MakeTextLowercase{#1}}}
%  \renewcommand{\textsc}[1]{\smallcapsspacing{\textsmallcaps{#1}}}
%\fi


% Prints an epigraph and speaker in sans serif, all-caps type.
\newcommand{\openepigraph}[2]{%
  %\sffamily\fontsize{14}{16}\selectfont
  \begin{fullwidth}
  \sffamily\large
  \begin{doublespace}
  \noindent\allcaps{#1}\\% epigraph
  \noindent\allcaps{#2}% author
  \end{doublespace}
  \end{fullwidth}
}

% Inserts a blank page
\newcommand{\blankpage}{\newpage\hbox{}\thispagestyle{empty}\newpage}

\usepackage{units}

% Typesets the font size, leading, and measure in the form of 10/12x26 pc.
\newcommand{\measure}[3]{#1/#2$\times$\unit[#3]{pc}}

% Macros for typesetting the documentation
\newcommand{\hlred}[1]{\textcolor{Maroon}{#1}}% prints in red
\newcommand{\hangleft}[1]{\makebox[0pt][r]{#1}}
\newcommand{\hairsp}{\hspace{1pt}}% hair space
\newcommand{\hquad}{\hskip0.5em\relax}% half quad space
\newcommand{\na}{\quad--}% used in tables for N/A cells

% Generates the index
\usepackage{makeidx}
\makeindex


\begin{document}

% Front matter
\frontmatter
\addtocontents{toc}{\protect\setcounter{tocdepth}{0}}
  
%  % r.1 blank page
%  \blankpage
%  
%% r.3 full title page
%\maketitle

% r.5 contents
\tableofcontents

% \listoffigures

% \listoftables

% r.7 dedication
%\cleardoublepage
%~\vfill
%\begin{doublespace}
%  \noindent\fontsize{12}{12}\selectfont\itshape
%  \nohyphenation
%  \hfill To my teachers.
%\end{doublespace}
%\vfill
%\vfill


% r.9 introduction
\cleardoublepage

\chapter{Introduction}
\input{./parts/0_intro.tex}

%%
% Start the main matter (normal chapters)
\mainmatter
\addtocontents{toc}{\protect\setcounter{tocdepth}{2}}  % later -> 1

\part{Theoretical Foundation}

\chapter{The Many Body Problem}
\input{./parts/1_dft.tex}

\chapter{Nuclear and Lattice Dynamics}
\input{./parts/2_lattice_dynamics.tex}
%
\chapter{Heat Transport}
\input{./parts/3_heat_transport.tex}


\part{Applications}

\chapter{Anharmonicity}
\input{./parts/4_anharmonicity.tex}

\chapter{Ab Initio Green Kubo: Implementation}
\input{./parts/5_implementation.tex}

\chapter{Thermal Conductivities for Strongly Anharmonic Compounds}
\input{./parts/results.tex}


% \addtocontents{toc}{\protect\setcounter{tocdepth}{0}}
% \addcontentsline{toc}{chapter}{Conclusion}
\chapter{Conclusion}
\input{./parts/conclusio.tex}

\cleardoublepage
\phantomsection
\addcontentsline{toc}{chapter}{Bibliography}

\bibliographystyle{unsrt}
\bibliography{references,references_experiments}

% \setcounter{secnumdepth}{-1}

\part*{Appendix}

% \setcounter{tocdepth}{1}
% \addtocontents{toc}{\setcounter{tocdepth}{0}}
\addtocontents{toc}{\protect\setcounter{tocdepth}{0}}
\newcommand{\bibsection}{\section{Bibliography}} % <- was missing

\begin{appendices}
%  \appendixpage
  \part*{Appendix}
  \input{./parts/appendix.tex}
\end{appendices}

% \backmatter



\end{document}
