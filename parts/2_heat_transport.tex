\subsection{Heat Transport}
\subsubsection{Linear Response Theory}
\cite{Einstein1905a,Onsager1931a,Onsager1931b,Kubo1957a,Kubo1957b}
\cite[p. 68]{Lomen1986} \cite{Tuckerman}

In order to establish the famous Green-Kubo relation for computing the thermal conductivity from equilibrium fluctuations of the heat flux,~i.\,e.,~by means of the fluctuation-dissipation theorem, we briefly review linear response theory for classical statistical mechanics. We do so by starting from a general Hamiltonian $H$ that is given in terms of the many-body Hamiltonian
\begin{align}
  H^0 (\Gamma) 
    = H^0(\set{\b R, \b P})
    = \sum_I \frac{\b P^2}{2 M_I} + V (\b R)~,
  \label{eq:lr.H0}
\end{align}
and some yet unspecified external perturbation $H'$. We write the full Hamiltonian as
\begin{align}
  H (\Gamma, t)
   = H^0 (\Gamma) + \lambda H' (\Gamma, t)~,
  \label{eq:lr.H}
\end{align}
where the perturbation is given by an external force $F(t)$ coupled to the system through a phase-space operator $A (\Gamma)$,
\begin{align}
  H' (\Gamma, t) = A (\Gamma) F (t)~,
  \label{eq:lr.H'}
\end{align}
with a bookkeeping parameter $\lambda = 1$ that we introduce to count the order in the perturbation $A$.

The canonical distribution function for the unperturbed system reads
\begin{align}
  f^0 (\Gamma) 
    = \frac{1}{\mathcal{Z}^0} {\rm e}^{- \beta H^0 (\Gamma)}~.
  \label{eq:lr.f0}
\end{align}
We write the distribution function in presence of the perturbation as
\begin{align}
  f (\Gamma, t) = f^0(\Gamma) + \lambda \Delta f (\Gamma, t)~,
  \label{eq:lr.f}
\end{align}
where $\Delta f$ is the difference between the perturbed an unperturbed distribution functions generated by $H'$. Using that $f^0$ carries no explicit time dependence, the Liouville equation for $\Delta f$ reads~\cite[p. 68]{Tuckerman}
\begin{align}
  \lambda \frac{\d \Delta f}{\d t}
    &= \set{H, f} \nonumber \\
    &= \lambda \set{H^0, \Delta f} 
      + \lambda \set{A, f^0} F(t)
      + \mathcal{O}(\lambda^2)~,
  \label{eq:lr.df.1} \\
  \implies
    \frac{\d \Delta f}{\d t}
      &\approx \braket{H^0 , \Delta f} + \set{A, f^0} F(t)
  \label{eq:lr.df.2}
\end{align}
where $\set{\cdot , \cdot}$ denotes the Poisson bracket\footnote{
  The Poisson bracket for a system of particles with $3N$ positions $q_i$ and conjugate momenta $p_i$ reads
  $$
  \set{A, B} = \sum_{i}
  \frac{\partial A}{\partial q_i} \frac{\partial B}{\partial p_i}
  - \frac{\partial A}{\partial p_i} \frac{\partial B}{\partial q_i}~.
  $$
  }, 
and in Eq.\,\eqref{eq:lr.df.2} we only keep the terms to linear order in the perturbation, hence the term \emph{linear response}.
To solve for $\Delta f(t)$, we introduce a shorthand notation such that
\begin{align}
  \frac{\d \Delta f}{\d t} = -\im L \Delta f(t) - \im \Delta L (t) f^0~,
  \label{eq:lr.df.3}
\end{align}
where the Liouville operator $L^0$ is defined by
\begin{align}
  \im L^0 g = \set{g, H^0}~,
  \label{eq:lr.L}
\end{align}
and similarly
\begin{align}
  \im \Delta L (t) g = \set{g, H'(t)}~.
  \label{eq:lr.L'}
\end{align}
Equation~\eqref{eq:lr.df.3} is a first order linear differential equation of the form
\begin{align}
  \frac{\d y}{\d t} + p(t) y = q(t)~,
  \label{eq:lr.dgl.1}
\end{align}
which is straightforward to solve by using an integrating factor\footnote{Identify $y = \Delta f$, $p(t) = \im L^0$, and $q(t) = - \im \Delta L (t) f^0$. Following Ref.~\cite[p.\,68]{Lomen1986}, we define the integrating factor \mbox{$\rho (t) = \exp(\int \d t \, p (t)) = \exp (\im L^0 t)$}, multiply Eq.\,\eqref{eq:lr.dgl.1} with $\rho (t)$, and use that \mbox{$\d/\d t \, \rho(t) = \rho(t) p(t)$} to obtain
  $$
  \frac{\d}{\d t} (\rho (t) y) = \rho(t) q(t)~.
  $$
  This gets integrated to
  $$
  \rho(t) y = \int_{-\infty}^t \d t' \, \rho(t') q(t')
  $$
  under the boundary condition $y (t \to -\infty) = 0$. In total we obtain
  $$
  y(t) = \rho^{-1} (t) \int_{-\infty}^t \d t' \, \rho(t') q(t')
  \implies
  \Delta f(t) 
    = - {\rm e}^{- \im L^0 t}  \int_{-\infty}^t \d t' \, {\rm e}^{\im L^0 t'} \im \Delta L (t') f^0~.
  $$
  }, and yields~\cite{Kubo1957a}
\begin{align}
  \Delta f (t) 
    = \int_{-\infty}^t {\rm e}^{-\im L^0 (t - t')} \set{A, f^0} F(t')~\d t'~.
  \label{eq:lr.df(t)}
\end{align}
This expression can be simplified in the canonical ensemble by using that \mbox{$\partial f^0 / \partial H^0 = -\beta f^0$}, which leads to
\begin{align*}
  \set{A, f^0}
    &= \sum_i \frac{\partial A}{\partial q_i} \frac{\partial f^0}{\partial p_i}
    - \frac{\partial A}{\partial p_i} \frac{\partial f^0}{\partial q_i} \\
    &= \sum_i \frac{\partial A}{\partial q_i} \frac{\partial f^0}{\partial H^0} \frac{\partial H^0}{\partial p_i}
    - \frac{\partial A}{\partial p_i} \frac{\partial f^0}{\partial H^0} \frac{\partial H^0}{\partial q_i} \\
    &= -\beta f^0 \sum_i
      \left( \frac{\partial A}{\partial p_i} \dot{q}_i +  \frac{\partial A}{\partial q_i} \dot{p}_i \right) \\
    &= -\beta f^0 \, \frac{\d A}{\d t}~,
\end{align*}
where in the second step Hamilton's equations of motion have been used.

We are now in position to formulate the expected response of a phase space observable $B$ in the presence of a perturbation described by the Hamiltonian $H'$,~i.\,e.,~
\begin{align}
  \Delta B (t) 
    &= \int \d \Gamma ~  B (\Gamma) \Delta f (\Gamma, t) \\
    &= - \beta \int_{-\infty}^t 
      \int \d \Gamma ~ f^0(\Gamma) \, 
       B (\Gamma) \, {\rm e}^{-\im L^0 (\Gamma) (t - t')} \dot{A}(\Gamma) F(t') ~ \d t' \\
    &= - \beta \int_{-\infty}^t 
      \braket{B(t) \dot{A}(t')}_0 F(t') ~ \d t'~,
  \label{eq:lr.dB}
\end{align}
where it was used that $a(t) = {\rm e}^{\im L^0 t} a(0) = a(0) {\rm e}^{-\im L^0 t}$~\cite[p.\,498]{Tuckerman}, and $\braket{\cdot}_0$ denotes a phase-space average with respect to the unperturbed distribution function $f^0 (\Gamma)$.

\REM{Local density and conserved currents} \CITE{Baroni}

\REM{Thermal gradient $\to$ thermal conductivity}


\subsubsection{Green and Kubo}
\subsubsection{Ab initio Virial Heat Flux}
\subsubsection{Ab initio Green Kubo}